"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/sign-up";
exports.ids = ["pages/api/sign-up"];
exports.modules = {

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("bcryptjs");

/***/ }),

/***/ "cookies":
/*!**************************!*\
  !*** external "cookies" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("cookies");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(api)/./auth.js":
/*!*****************!*\
  !*** ./auth.js ***!
  \*****************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"cookie_options\": () => (/* binding */ cookie_options),\n/* harmony export */   \"saveSession\": () => (/* binding */ saveSession),\n/* harmony export */   \"verifyUser\": () => (/* binding */ verifyUser)\n/* harmony export */ });\n/* harmony import */ var _database_model__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./database/model */ \"(api)/./database/model.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst crypto = __webpack_require__(/*! crypto */ \"crypto\");\n\n\nconst cookie_options = {\n  httpOnly: true,\n  maxAge: 60 * 60 * 1000 * 24,\n  sameSite: \"strict\",\n  signed: true\n};\nasync function saveSession(data) {\n  //create random sid\n  const sid = crypto.randomBytes(18).toString(\"base64\"); //run create session in model.js, which inserts session into db (data and sid)\n\n  return (0,_database_model__WEBPACK_IMPORTED_MODULE_0__.createSession)(sid, data);\n} //called in log-in\n\nasync function verifyUser(email, password) {\n  //calls getUser in model\n  const savedUser = await (0,_database_model__WEBPACK_IMPORTED_MODULE_0__.getUser)(email);\n\n  if (savedUser[0]) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(password, savedUser[0].password).then(match => {\n      if (!match) {\n        return undefined;\n      } else {\n        delete savedUser[0].password;\n        return savedUser;\n      }\n    });\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9hdXRoLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBLE1BQU1FLE1BQU0sR0FBR0MsbUJBQU8sQ0FBQyxzQkFBRCxDQUF0Qjs7QUFDQTtBQUVPLE1BQU1FLGNBQWMsR0FBRztBQUM1QkMsRUFBQUEsUUFBUSxFQUFFLElBRGtCO0FBRTVCQyxFQUFBQSxNQUFNLEVBQUUsS0FBSyxFQUFMLEdBQVUsSUFBVixHQUFpQixFQUZHO0FBRzVCQyxFQUFBQSxRQUFRLEVBQUUsUUFIa0I7QUFJNUJDLEVBQUFBLE1BQU0sRUFBRTtBQUpvQixDQUF2QjtBQU9BLGVBQWVDLFdBQWYsQ0FBMkJDLElBQTNCLEVBQWlDO0FBQ3RDO0FBQ0EsUUFBTUMsR0FBRyxHQUFHVixNQUFNLENBQUNXLFdBQVAsQ0FBbUIsRUFBbkIsRUFBdUJDLFFBQXZCLENBQWdDLFFBQWhDLENBQVosQ0FGc0MsQ0FHdEM7O0FBQ0EsU0FBT2QsOERBQWEsQ0FBQ1ksR0FBRCxFQUFNRCxJQUFOLENBQXBCO0FBQ0QsRUFFRDs7QUFDTyxlQUFlSSxVQUFmLENBQTBCQyxLQUExQixFQUFpQ0MsUUFBakMsRUFBMkM7QUFDaEQ7QUFDQSxRQUFNQyxTQUFTLEdBQUcsTUFBTWpCLHdEQUFPLENBQUNlLEtBQUQsQ0FBL0I7O0FBQ0EsTUFBSUUsU0FBUyxDQUFDLENBQUQsQ0FBYixFQUFrQjtBQUNoQixXQUFPZCx1REFBQSxDQUFlYSxRQUFmLEVBQXlCQyxTQUFTLENBQUMsQ0FBRCxDQUFULENBQWFELFFBQXRDLEVBQWdERyxJQUFoRCxDQUFzREMsS0FBRCxJQUFXO0FBQ3JFLFVBQUksQ0FBQ0EsS0FBTCxFQUFZO0FBQ1YsZUFBT0MsU0FBUDtBQUNELE9BRkQsTUFFTztBQUNMLGVBQU9KLFNBQVMsQ0FBQyxDQUFELENBQVQsQ0FBYUQsUUFBcEI7QUFDQSxlQUFPQyxTQUFQO0FBQ0Q7QUFDRixLQVBNLENBQVA7QUFRRDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhhbS1ncmFkZS1ib29zdC8uL2F1dGguanM/ZjU1ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVTZXNzaW9uLCBnZXRVc2VyIH0gZnJvbSBcIi4vZGF0YWJhc2UvbW9kZWxcIjtcbmNvbnN0IGNyeXB0byA9IHJlcXVpcmUoXCJjcnlwdG9cIik7XG5pbXBvcnQgYmNyeXB0IGZyb20gXCJiY3J5cHRqc1wiO1xuXG5leHBvcnQgY29uc3QgY29va2llX29wdGlvbnMgPSB7XG4gIGh0dHBPbmx5OiB0cnVlLFxuICBtYXhBZ2U6IDYwICogNjAgKiAxMDAwICogMjQsXG4gIHNhbWVTaXRlOiBcInN0cmljdFwiLFxuICBzaWduZWQ6IHRydWUsXG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZVNlc3Npb24oZGF0YSkge1xuICAvL2NyZWF0ZSByYW5kb20gc2lkXG4gIGNvbnN0IHNpZCA9IGNyeXB0by5yYW5kb21CeXRlcygxOCkudG9TdHJpbmcoXCJiYXNlNjRcIik7XG4gIC8vcnVuIGNyZWF0ZSBzZXNzaW9uIGluIG1vZGVsLmpzLCB3aGljaCBpbnNlcnRzIHNlc3Npb24gaW50byBkYiAoZGF0YSBhbmQgc2lkKVxuICByZXR1cm4gY3JlYXRlU2Vzc2lvbihzaWQsIGRhdGEpO1xufVxuXG4vL2NhbGxlZCBpbiBsb2ctaW5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlVc2VyKGVtYWlsLCBwYXNzd29yZCkge1xuICAvL2NhbGxzIGdldFVzZXIgaW4gbW9kZWxcbiAgY29uc3Qgc2F2ZWRVc2VyID0gYXdhaXQgZ2V0VXNlcihlbWFpbCk7XG4gIGlmIChzYXZlZFVzZXJbMF0pIHtcbiAgICByZXR1cm4gYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHNhdmVkVXNlclswXS5wYXNzd29yZCkudGhlbigobWF0Y2gpID0+IHtcbiAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRlbGV0ZSBzYXZlZFVzZXJbMF0ucGFzc3dvcmQ7XG4gICAgICAgIHJldHVybiBzYXZlZFVzZXI7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0iXSwibmFtZXMiOlsiY3JlYXRlU2Vzc2lvbiIsImdldFVzZXIiLCJjcnlwdG8iLCJyZXF1aXJlIiwiYmNyeXB0IiwiY29va2llX29wdGlvbnMiLCJodHRwT25seSIsIm1heEFnZSIsInNhbWVTaXRlIiwic2lnbmVkIiwic2F2ZVNlc3Npb24iLCJkYXRhIiwic2lkIiwicmFuZG9tQnl0ZXMiLCJ0b1N0cmluZyIsInZlcmlmeVVzZXIiLCJlbWFpbCIsInBhc3N3b3JkIiwic2F2ZWRVc2VyIiwiY29tcGFyZSIsInRoZW4iLCJtYXRjaCIsInVuZGVmaW5lZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./auth.js\n");

/***/ }),

/***/ "(api)/./database/connection.js":
/*!********************************!*\
  !*** ./database/connection.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst pg = __webpack_require__(/*! pg */ \"pg\");\n\nconst DB_URL = process.env.DATABASE_URL;\nif (!DB_URL) throw new Error(\"no database URL env var!\");\nconst options = {\n  connectionString: DB_URL,\n  max: 40\n};\nconst db = new pg.Pool(options);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (db);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9kYXRhYmFzZS9jb25uZWN0aW9uLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxNQUFNQSxFQUFFLEdBQUdDLG1CQUFPLENBQUMsY0FBRCxDQUFsQjs7QUFDQSxNQUFNQyxNQUFNLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUEzQjtBQUVBLElBQUksQ0FBQ0gsTUFBTCxFQUFhLE1BQU0sSUFBSUksS0FBSixDQUFVLDBCQUFWLENBQU47QUFFYixNQUFNQyxPQUFPLEdBQUc7QUFDZEMsRUFBQUEsZ0JBQWdCLEVBQUVOLE1BREo7QUFFZE8sRUFBQUEsR0FBRyxFQUFFO0FBRlMsQ0FBaEI7QUFLQSxNQUFNQyxFQUFFLEdBQUcsSUFBSVYsRUFBRSxDQUFDVyxJQUFQLENBQVlKLE9BQVosQ0FBWDtBQUVBLGlFQUFlRyxFQUFmIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhhbS1ncmFkZS1ib29zdC8uL2RhdGFiYXNlL2Nvbm5lY3Rpb24uanM/ZjMwNSJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBwZyA9IHJlcXVpcmUoXCJwZ1wiKTtcbmNvbnN0IERCX1VSTCA9IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTDtcblxuaWYgKCFEQl9VUkwpIHRocm93IG5ldyBFcnJvcihcIm5vIGRhdGFiYXNlIFVSTCBlbnYgdmFyIVwiKTtcblxuY29uc3Qgb3B0aW9ucyA9IHtcbiAgY29ubmVjdGlvblN0cmluZzogREJfVVJMLFxuICBtYXg6IDQwLFxufTtcblxuY29uc3QgZGIgPSBuZXcgcGcuUG9vbChvcHRpb25zKTtcblxuZXhwb3J0IGRlZmF1bHQgZGI7XG4iXSwibmFtZXMiOlsicGciLCJyZXF1aXJlIiwiREJfVVJMIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsIkVycm9yIiwib3B0aW9ucyIsImNvbm5lY3Rpb25TdHJpbmciLCJtYXgiLCJkYiIsIlBvb2wiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./database/connection.js\n");

/***/ }),

/***/ "(api)/./database/model.js":
/*!***************************!*\
  !*** ./database/model.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"createUser\": () => (/* binding */ createUser),\n/* harmony export */   \"createSession\": () => (/* binding */ createSession),\n/* harmony export */   \"getUser\": () => (/* binding */ getUser),\n/* harmony export */   \"getContactInfo\": () => (/* binding */ getContactInfo),\n/* harmony export */   \"deleteCurrSession\": () => (/* binding */ deleteCurrSession),\n/* harmony export */   \"getSessionInfo\": () => (/* binding */ getSessionInfo)\n/* harmony export */ });\n/* harmony import */ var _database_connection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../database/connection */ \"(api)/./database/connection.js\");\n //adds new user to user table, returning user id, username and email\n\nfunction createUser(username, email, hashedPassword) {\n  const INSERT_USER = `INSERT INTO users (username, email, password) VALUES ($1, $2, $3) RETURNING id, username, email`;\n  return _database_connection__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query(INSERT_USER, [username, email, hashedPassword]).then(result => {\n    return result.rows[0];\n  });\n} //adds new session to sessions table and returns sid\n\nfunction createSession(sid, data) {\n  const CREATE_SESSION = `INSERT INTO sessions (sid, data) VALUES ($1, $2) RETURNING sid`;\n  return _database_connection__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query(CREATE_SESSION, [sid, data]).then(result => {\n    return result.rows[0].sid;\n  });\n} //returns all data from user table including password\n\nfunction getUser(email) {\n  const GET_USER = `SELECT * FROM users WHERE email = $1`;\n  return _database_connection__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query(GET_USER, [email]).then(result => {\n    return result.rows;\n  });\n} //returns username and email stored for a specified user_id\n\nfunction getContactInfo(user_id) {\n  const GET_USER = `SELECT username, email FROM users WHERE id = $1`;\n  return _database_connection__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query(GET_USER, [user_id]).then(result => {\n    return result.rows[0];\n  });\n} //deletes a session from sessions table with correspinding sid\n\nfunction deleteCurrSession(sid) {\n  const DELETE_SESSION = `\n    DELETE FROM sessions WHERE sid = $1`;\n  return _database_connection__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query(DELETE_SESSION, [sid]);\n} //returns data saved in saveSession function\n//in most basic form this an object shaped like this: {user_id: 1}\n//used to obtain user id when only the sid is known on the client\n\nfunction getSessionInfo(sid) {\n  const CURRENT_SESSION = `\n    SELECT data FROM sessions WHERE sid = $1`;\n  return _database_connection__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query(CURRENT_SESSION, [sid]).then(result => {\n    return result.rows[0];\n  }).catch(error => console.log(error));\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9kYXRhYmFzZS9tb2RlbC5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0NBRUE7O0FBQ08sU0FBU0MsVUFBVCxDQUFvQkMsUUFBcEIsRUFBOEJDLEtBQTlCLEVBQXFDQyxjQUFyQyxFQUFxRDtBQUMxRCxRQUFNQyxXQUFXLEdBQUksaUdBQXJCO0FBQ0EsU0FBT0wsa0VBQUEsQ0FDRUssV0FERixFQUNlLENBQUNILFFBQUQsRUFBV0MsS0FBWCxFQUFrQkMsY0FBbEIsQ0FEZixFQUVKRyxJQUZJLENBRUVDLE1BQUQsSUFBWTtBQUNoQixXQUFPQSxNQUFNLENBQUNDLElBQVAsQ0FBWSxDQUFaLENBQVA7QUFDRCxHQUpJLENBQVA7QUFLRCxFQUVEOztBQUNPLFNBQVNDLGFBQVQsQ0FBdUJDLEdBQXZCLEVBQTRCQyxJQUE1QixFQUFrQztBQUN2QyxRQUFNQyxjQUFjLEdBQUksZ0VBQXhCO0FBQ0EsU0FBT2Isa0VBQUEsQ0FBU2EsY0FBVCxFQUF5QixDQUFDRixHQUFELEVBQU1DLElBQU4sQ0FBekIsRUFBc0NMLElBQXRDLENBQTRDQyxNQUFELElBQVk7QUFDNUQsV0FBT0EsTUFBTSxDQUFDQyxJQUFQLENBQVksQ0FBWixFQUFlRSxHQUF0QjtBQUNELEdBRk0sQ0FBUDtBQUdELEVBRUQ7O0FBQ08sU0FBU0csT0FBVCxDQUFpQlgsS0FBakIsRUFBd0I7QUFDN0IsUUFBTVksUUFBUSxHQUFJLHNDQUFsQjtBQUNBLFNBQU9mLGtFQUFBLENBQVNlLFFBQVQsRUFBbUIsQ0FBQ1osS0FBRCxDQUFuQixFQUE0QkksSUFBNUIsQ0FBa0NDLE1BQUQsSUFBWTtBQUNsRCxXQUFPQSxNQUFNLENBQUNDLElBQWQ7QUFDRCxHQUZNLENBQVA7QUFHRCxFQUVEOztBQUNPLFNBQVNPLGNBQVQsQ0FBd0JDLE9BQXhCLEVBQWlDO0FBQ3RDLFFBQU1GLFFBQVEsR0FBSSxpREFBbEI7QUFDQSxTQUFPZixrRUFBQSxDQUFTZSxRQUFULEVBQW1CLENBQUNFLE9BQUQsQ0FBbkIsRUFBOEJWLElBQTlCLENBQW9DQyxNQUFELElBQVk7QUFDcEQsV0FBT0EsTUFBTSxDQUFDQyxJQUFQLENBQVksQ0FBWixDQUFQO0FBQ0QsR0FGTSxDQUFQO0FBR0QsRUFFRDs7QUFDTyxTQUFTUyxpQkFBVCxDQUEyQlAsR0FBM0IsRUFBZ0M7QUFDckMsUUFBTVEsY0FBYyxHQUFJO0FBQzFCLHdDQURFO0FBRUEsU0FBT25CLGtFQUFBLENBQVNtQixjQUFULEVBQXlCLENBQUNSLEdBQUQsQ0FBekIsQ0FBUDtBQUNELEVBRUQ7QUFDQTtBQUNBOztBQUNPLFNBQVNTLGNBQVQsQ0FBd0JULEdBQXhCLEVBQTZCO0FBQ2xDLFFBQU1VLGVBQWUsR0FBSTtBQUMzQiw2Q0FERTtBQUVBLFNBQU9yQixrRUFBQSxDQUNFcUIsZUFERixFQUNtQixDQUFDVixHQUFELENBRG5CLEVBRUpKLElBRkksQ0FFRUMsTUFBRCxJQUFZO0FBQ2hCLFdBQU9BLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZLENBQVosQ0FBUDtBQUNELEdBSkksRUFLSmEsS0FMSSxDQUtHQyxLQUFELElBQVdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixLQUFaLENBTGIsQ0FBUDtBQU1EIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhhbS1ncmFkZS1ib29zdC8uL2RhdGFiYXNlL21vZGVsLmpzPzMwZWYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGRiIGZyb20gXCIuLi9kYXRhYmFzZS9jb25uZWN0aW9uXCI7XG5cbi8vYWRkcyBuZXcgdXNlciB0byB1c2VyIHRhYmxlLCByZXR1cm5pbmcgdXNlciBpZCwgdXNlcm5hbWUgYW5kIGVtYWlsXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVXNlcih1c2VybmFtZSwgZW1haWwsIGhhc2hlZFBhc3N3b3JkKSB7XG4gIGNvbnN0IElOU0VSVF9VU0VSID0gYElOU0VSVCBJTlRPIHVzZXJzICh1c2VybmFtZSwgZW1haWwsIHBhc3N3b3JkKSBWQUxVRVMgKCQxLCAkMiwgJDMpIFJFVFVSTklORyBpZCwgdXNlcm5hbWUsIGVtYWlsYDtcbiAgcmV0dXJuIGRiXG4gICAgLnF1ZXJ5KElOU0VSVF9VU0VSLCBbdXNlcm5hbWUsIGVtYWlsLCBoYXNoZWRQYXNzd29yZF0pXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICAgIH0pO1xufVxuXG4vL2FkZHMgbmV3IHNlc3Npb24gdG8gc2Vzc2lvbnMgdGFibGUgYW5kIHJldHVybnMgc2lkXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2Vzc2lvbihzaWQsIGRhdGEpIHtcbiAgY29uc3QgQ1JFQVRFX1NFU1NJT04gPSBgSU5TRVJUIElOVE8gc2Vzc2lvbnMgKHNpZCwgZGF0YSkgVkFMVUVTICgkMSwgJDIpIFJFVFVSTklORyBzaWRgO1xuICByZXR1cm4gZGIucXVlcnkoQ1JFQVRFX1NFU1NJT04sIFtzaWQsIGRhdGFdKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0uc2lkO1xuICB9KTtcbn1cblxuLy9yZXR1cm5zIGFsbCBkYXRhIGZyb20gdXNlciB0YWJsZSBpbmNsdWRpbmcgcGFzc3dvcmRcbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyKGVtYWlsKSB7XG4gIGNvbnN0IEdFVF9VU0VSID0gYFNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgZW1haWwgPSAkMWA7XG4gIHJldHVybiBkYi5xdWVyeShHRVRfVVNFUiwgW2VtYWlsXSkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9KTtcbn1cblxuLy9yZXR1cm5zIHVzZXJuYW1lIGFuZCBlbWFpbCBzdG9yZWQgZm9yIGEgc3BlY2lmaWVkIHVzZXJfaWRcbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250YWN0SW5mbyh1c2VyX2lkKSB7XG4gIGNvbnN0IEdFVF9VU0VSID0gYFNFTEVDVCB1c2VybmFtZSwgZW1haWwgRlJPTSB1c2VycyBXSEVSRSBpZCA9ICQxYDtcbiAgcmV0dXJuIGRiLnF1ZXJ5KEdFVF9VU0VSLCBbdXNlcl9pZF0pLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfSk7XG59XG5cbi8vZGVsZXRlcyBhIHNlc3Npb24gZnJvbSBzZXNzaW9ucyB0YWJsZSB3aXRoIGNvcnJlc3BpbmRpbmcgc2lkXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlQ3VyclNlc3Npb24oc2lkKSB7XG4gIGNvbnN0IERFTEVURV9TRVNTSU9OID0gYFxuICAgIERFTEVURSBGUk9NIHNlc3Npb25zIFdIRVJFIHNpZCA9ICQxYDtcbiAgcmV0dXJuIGRiLnF1ZXJ5KERFTEVURV9TRVNTSU9OLCBbc2lkXSk7XG59XG5cbi8vcmV0dXJucyBkYXRhIHNhdmVkIGluIHNhdmVTZXNzaW9uIGZ1bmN0aW9uXG4vL2luIG1vc3QgYmFzaWMgZm9ybSB0aGlzIGFuIG9iamVjdCBzaGFwZWQgbGlrZSB0aGlzOiB7dXNlcl9pZDogMX1cbi8vdXNlZCB0byBvYnRhaW4gdXNlciBpZCB3aGVuIG9ubHkgdGhlIHNpZCBpcyBrbm93biBvbiB0aGUgY2xpZW50XG5leHBvcnQgZnVuY3Rpb24gZ2V0U2Vzc2lvbkluZm8oc2lkKSB7XG4gIGNvbnN0IENVUlJFTlRfU0VTU0lPTiA9IGBcbiAgICBTRUxFQ1QgZGF0YSBGUk9NIHNlc3Npb25zIFdIRVJFIHNpZCA9ICQxYDtcbiAgcmV0dXJuIGRiXG4gICAgLnF1ZXJ5KENVUlJFTlRfU0VTU0lPTiwgW3NpZF0pXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5sb2coZXJyb3IpKTtcbn0iXSwibmFtZXMiOlsiZGIiLCJjcmVhdGVVc2VyIiwidXNlcm5hbWUiLCJlbWFpbCIsImhhc2hlZFBhc3N3b3JkIiwiSU5TRVJUX1VTRVIiLCJxdWVyeSIsInRoZW4iLCJyZXN1bHQiLCJyb3dzIiwiY3JlYXRlU2Vzc2lvbiIsInNpZCIsImRhdGEiLCJDUkVBVEVfU0VTU0lPTiIsImdldFVzZXIiLCJHRVRfVVNFUiIsImdldENvbnRhY3RJbmZvIiwidXNlcl9pZCIsImRlbGV0ZUN1cnJTZXNzaW9uIiwiREVMRVRFX1NFU1NJT04iLCJnZXRTZXNzaW9uSW5mbyIsIkNVUlJFTlRfU0VTU0lPTiIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./database/model.js\n");

/***/ }),

/***/ "(api)/./pages/api/sign-up.js":
/*!******************************!*\
  !*** ./pages/api/sign-up.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"hashPassword\": () => (/* binding */ hashPassword),\n/* harmony export */   \"default\": () => (/* binding */ sign_up)\n/* harmony export */ });\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../auth */ \"(api)/./auth.js\");\n/* harmony import */ var _database_model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../database/model */ \"(api)/./database/model.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var cookies__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! cookies */ \"cookies\");\n/* harmony import */ var cookies__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(cookies__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nfunction hashPassword(password) {\n  return bcryptjs__WEBPACK_IMPORTED_MODULE_2___default().hash(password, 10);\n}\nasync function sign_up(req, res) {\n  //req.method checks the HTTP header method - if it is a POST\n  switch (req.method) {\n    case \"POST\":\n      {\n        //destructured obj from req.body takes form input which is then\n        const {\n          username,\n          email,\n          password\n        } = req.body;\n        const hashedPassword = await hashPassword(password); //user data is parsed into the createUser which adds new user to user table in db\n\n        const user = await (0,_database_model__WEBPACK_IMPORTED_MODULE_1__.createUser)(username, email, hashedPassword).catch(error => {\n          console.log(error);\n          res.redirect(303, \"/emailError\");\n        });\n        console.log({\n          user\n        }); //session saved in auth which calls createSession in model\n\n        const sid = await (0,_auth__WEBPACK_IMPORTED_MODULE_0__.saveSession)({\n          user_id: user.id\n        }); //set cookies\n\n        const cookies = new (cookies__WEBPACK_IMPORTED_MODULE_3___default())(req, res);\n        cookies.set(\"sid\", `${sid}`, {\n          maxAge: _auth__WEBPACK_IMPORTED_MODULE_0__.cookie_options.maxAge\n        }); //redirect to home\n\n        res.redirect(303, \"/home\");\n        break;\n      }\n\n    default:\n      res.status(405).send(\"Method not allowed\");\n      break;\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvc2lnbi11cC5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRU8sU0FBU0ssWUFBVCxDQUFzQkMsUUFBdEIsRUFBZ0M7QUFDckMsU0FBT0gsb0RBQUEsQ0FBWUcsUUFBWixFQUFzQixFQUF0QixDQUFQO0FBQ0Q7QUFFYyxlQUFlRSxPQUFmLENBQXVCQyxHQUF2QixFQUE0QkMsR0FBNUIsRUFBaUM7QUFDOUM7QUFDQSxVQUFRRCxHQUFHLENBQUNFLE1BQVo7QUFDRSxTQUFLLE1BQUw7QUFBYTtBQUNYO0FBQ0EsY0FBTTtBQUFFQyxVQUFBQSxRQUFGO0FBQVlDLFVBQUFBLEtBQVo7QUFBbUJQLFVBQUFBO0FBQW5CLFlBQWdDRyxHQUFHLENBQUNLLElBQTFDO0FBRUEsY0FBTUMsY0FBYyxHQUFHLE1BQU1WLFlBQVksQ0FBQ0MsUUFBRCxDQUF6QyxDQUpXLENBTVg7O0FBQ0EsY0FBTVUsSUFBSSxHQUFHLE1BQU1kLDJEQUFVLENBQUNVLFFBQUQsRUFBV0MsS0FBWCxFQUFrQkUsY0FBbEIsQ0FBVixDQUE0Q0UsS0FBNUMsQ0FDaEJDLEtBQUQsSUFBVztBQUNUQyxVQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUYsS0FBWjtBQUNBUixVQUFBQSxHQUFHLENBQUNXLFFBQUosQ0FBYSxHQUFiLEVBQWtCLGFBQWxCO0FBQ0QsU0FKZ0IsQ0FBbkI7QUFPQUYsUUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVk7QUFBRUosVUFBQUE7QUFBRixTQUFaLEVBZFcsQ0FnQlg7O0FBQ0EsY0FBTU0sR0FBRyxHQUFHLE1BQU1yQixrREFBVyxDQUFDO0FBQUVzQixVQUFBQSxPQUFPLEVBQUVQLElBQUksQ0FBQ1E7QUFBaEIsU0FBRCxDQUE3QixDQWpCVyxDQW1CWDs7QUFDQSxjQUFNQyxPQUFPLEdBQUcsSUFBSXJCLGdEQUFKLENBQVlLLEdBQVosRUFBaUJDLEdBQWpCLENBQWhCO0FBQ0FlLFFBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLEtBQVosRUFBb0IsR0FBRUosR0FBSSxFQUExQixFQUE2QjtBQUMzQkssVUFBQUEsTUFBTSxFQUFFM0Isd0RBQXFCMkI7QUFERixTQUE3QixFQXJCVyxDQXlCWDs7QUFDQWpCLFFBQUFBLEdBQUcsQ0FBQ1csUUFBSixDQUFhLEdBQWIsRUFBa0IsT0FBbEI7QUFDQTtBQUNEOztBQUNEO0FBQ0VYLE1BQUFBLEdBQUcsQ0FBQ2tCLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixvQkFBckI7QUFDQTtBQWhDSjtBQWtDRCIsInNvdXJjZXMiOlsid2VicGFjazovL2V4YW0tZ3JhZGUtYm9vc3QvLi9wYWdlcy9hcGkvc2lnbi11cC5qcz84YWIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvb2tpZV9vcHRpb25zLCBzYXZlU2Vzc2lvbiB9IGZyb20gXCIuLi8uLi9hdXRoXCI7XG5pbXBvcnQgeyBjcmVhdGVVc2VyIH0gZnJvbSBcIi4uLy4uL2RhdGFiYXNlL21vZGVsXCI7XG5pbXBvcnQgYmNyeXB0IGZyb20gXCJiY3J5cHRqc1wiO1xuaW1wb3J0IENvb2tpZXMgZnJvbSBcImNvb2tpZXNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGhhc2hQYXNzd29yZChwYXNzd29yZCkge1xuICByZXR1cm4gYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gc2lnbl91cChyZXEsIHJlcykge1xuICAvL3JlcS5tZXRob2QgY2hlY2tzIHRoZSBIVFRQIGhlYWRlciBtZXRob2QgLSBpZiBpdCBpcyBhIFBPU1RcbiAgc3dpdGNoIChyZXEubWV0aG9kKSB7XG4gICAgY2FzZSBcIlBPU1RcIjoge1xuICAgICAgLy9kZXN0cnVjdHVyZWQgb2JqIGZyb20gcmVxLmJvZHkgdGFrZXMgZm9ybSBpbnB1dCB3aGljaCBpcyB0aGVuXG4gICAgICBjb25zdCB7IHVzZXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuXG4gICAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGhhc2hQYXNzd29yZChwYXNzd29yZCk7XG5cbiAgICAgIC8vdXNlciBkYXRhIGlzIHBhcnNlZCBpbnRvIHRoZSBjcmVhdGVVc2VyIHdoaWNoIGFkZHMgbmV3IHVzZXIgdG8gdXNlciB0YWJsZSBpbiBkYlxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGNyZWF0ZVVzZXIodXNlcm5hbWUsIGVtYWlsLCBoYXNoZWRQYXNzd29yZCkuY2F0Y2goXG4gICAgICAgIChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICByZXMucmVkaXJlY3QoMzAzLCBcIi9lbWFpbEVycm9yXCIpO1xuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgICBjb25zb2xlLmxvZyh7IHVzZXIgfSk7XG5cbiAgICAgIC8vc2Vzc2lvbiBzYXZlZCBpbiBhdXRoIHdoaWNoIGNhbGxzIGNyZWF0ZVNlc3Npb24gaW4gbW9kZWxcbiAgICAgIGNvbnN0IHNpZCA9IGF3YWl0IHNhdmVTZXNzaW9uKHsgdXNlcl9pZDogdXNlci5pZCB9KTtcblxuICAgICAgLy9zZXQgY29va2llc1xuICAgICAgY29uc3QgY29va2llcyA9IG5ldyBDb29raWVzKHJlcSwgcmVzKTtcbiAgICAgIGNvb2tpZXMuc2V0KFwic2lkXCIsIGAke3NpZH1gLCB7XG4gICAgICAgIG1heEFnZTogY29va2llX29wdGlvbnMubWF4QWdlLFxuICAgICAgfSk7XG5cbiAgICAgIC8vcmVkaXJlY3QgdG8gaG9tZVxuICAgICAgcmVzLnJlZGlyZWN0KDMwMywgXCIvaG9tZVwiKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBkZWZhdWx0OlxuICAgICAgcmVzLnN0YXR1cyg0MDUpLnNlbmQoXCJNZXRob2Qgbm90IGFsbG93ZWRcIik7XG4gICAgICBicmVhaztcbiAgfVxufSJdLCJuYW1lcyI6WyJjb29raWVfb3B0aW9ucyIsInNhdmVTZXNzaW9uIiwiY3JlYXRlVXNlciIsImJjcnlwdCIsIkNvb2tpZXMiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsImhhc2giLCJzaWduX3VwIiwicmVxIiwicmVzIiwibWV0aG9kIiwidXNlcm5hbWUiLCJlbWFpbCIsImJvZHkiLCJoYXNoZWRQYXNzd29yZCIsInVzZXIiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInJlZGlyZWN0Iiwic2lkIiwidXNlcl9pZCIsImlkIiwiY29va2llcyIsInNldCIsIm1heEFnZSIsInN0YXR1cyIsInNlbmQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/sign-up.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/sign-up.js"));
module.exports = __webpack_exports__;

})();